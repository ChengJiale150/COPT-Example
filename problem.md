# 问题 (Problem)

## 问题描述 (Problem Description)
一家工厂生产两种食品（I 和 II），计划在8周内完成一项紧急的生产与人员培训任务。工厂初期拥有50名熟练工，并计划在第8周结束前再培训50名新工人。

核心任务是在满足每周不断增长的产品需求的同时，合理安排现有工人的生产、加班与培训任务，并招募和培训新工人，目标是使未来8周的总成本（包括工人工资和延期交货罚款）最小化。

具体条件如下：
*   **生产效率**: 每名熟练工每周工作40小时（常规）或60小时（加班）。每小时可生产10公斤食品I或6公斤食品II。
*   **人员与工资**:
    *   初始熟练工：50名，周薪360元（常规）或540元（加班）。
    *   新工人：培训期周薪120元，培训合格后周薪240元（常规）或540元（加班），生产效率与熟练工相同。
*   **培训**:
    *   培训周期为2周。
    *   1名熟練工在2周内最多可培训3名新工人。
    *   在培训期间，培训师（熟练工）和学员（新工人）均不参与生产。
*   **需求与罚款**:
    *   两种食品每周有明确的合同预订量。
    *   若未能按时交付，每延迟一周，每公斤食品I的罚款为0.5元，食品II为0.6元。

## 问题分析 (Problem Analysis)
这是一个典型的**多周期动态规划 (Multi-period Dynamic Planning)** 问题，可以被构建为一个**混合整数线性规划 (Mixed-Integer Linear Programming, MILP)** 模型。

该问题的核心是在多个相互关联的周期内，做出最优的资源（劳动力）分配决策。决策的动态性体现在：本周开始的培训决策会直接影响未来两周的劳动力可用性，并最终影响到整个计划周期内的生产能力和成本。模型需要精确地权衡短期成本（如加班费、培训开销）与长期成本（如因生产力不足导致的延期罚款）。

### 核心假设 (Core Assumptions)
为将现实问题转化为严谨的数学模型，我们做出以下关键假设：
1.  **按订单生产**: 模型不考虑提前生产以建立库存，只追踪和惩罚未完成的积压订单。
2.  **培训组固定**: 一个培训批次（包含培训师和学员）一旦在第 `t` 周组成，其人员将在 `t` 和 `t+1` 两周内保持不变，专注于培训任务。
3.  **新员工作为培训师**: 培训合格的新工人立即具备与初始熟练工同等的生产效率和培训资格，可以被指派为培训师。
4.  **培训工作时长**: 培训是一项标准的、每周40小时的工作，不适用加班制度。

## 数据定义 (Data Definition)
此问题中的数据可以被系统地组织为集合和参数。

*   **集合 (Sets)**
    *   $T$: 计划周期的集合, $T = \{1, 2, \dots, 8\}$。
    *   $P$: 食品产品的集合, $P = \{I, II\}$。

*   **参数 (Parameters)**
    *   $S_{orig}$: 初始熟练工的数量, $S_{orig} = 50$。
    *   $N_{target}$: 目标培训的新工人数, $N_{target} = 50$。
    *   $H_{reg}$: 常规工作时长 (小时/周), $H_{reg} = 40$。
    *   $H_{ot}$: 加班工作时长 (小时/周), $H_{ot} = 60$。
    *   $R_p$: 生产1公斤产品 $p$ 所需的工时 (小时/公斤)。
        *   $R_I = 1/10 = 0.1$ 小时/公斤。
        *   $R_{II} = 1/6$ 小时/公斤。
    *   $K$: 每名培训师在单个培训周期内可带的学员数, $K = 3$。
    *   $\tau$: 培训周期 (周), $\tau = 2$。
    *   $W_{orig\_reg}$: 初始熟练工常规周薪, $W_{orig\_reg} = 360$ 元。
    *   $W_{new\_reg}$: 新熟练工常规周薪, $W_{new\_reg} = 240$ 元。
    *   $W_{ot}$: 加班周薪 (新老员工相同), $W_{ot} = 540$ 元。
    *   $W_{trainee}$: 学员周薪, $W_{trainee} = 120$ 元。
    *   $C_p$: 产品 $p$ 的周延期罚款 (元/公斤), $C_I = 0.5, C_{II} = 0.6$。
    *   $D_{p,t}$: 第 $t$ 周对产品 $p$ 的需求量 (公斤)，具体数值如下表：

| 周 $t$ | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **需求 $D_{I,t}$** | 10000 | 10000 | 12000 | 12000 | 16000 | 16000 | 20000 | 20000 |
| **需求 $D_{II,t}$** | 6000 | 7200 | 8400 | 10800 | 10800 | 12000 | 12000 | 12000 |

# 数学形式 (Mathematical Formulation)

## 变量定义 (Variable Definition)
为了描述每周的决策和状态，我们定义以下变量（其中 $t \in T, p \in P$）：

*   **人员分配决策变量 (整数类型)**
    *   $s_{orig,t}^{reg}$: 第 $t$ 周从事常规生产的**初始**熟练工人数。
    *   $s_{orig,t}^{ot}$: 第 $t$ 周从事加班生产的**初始**熟练工人数。
    *   $s_{new,t}^{reg}$: 第 $t$ 周从事常规生产的**新**熟练工人数。
    *   $s_{new,t}^{ot}$: 第 $t$ 周从事加班生产的**新**熟练工人数。
    *   $T_{orig,t}$: 第 $t$ 周**开始**一个为期两周培训任务的**初始**熟练工（培训师）人数。
    *   $T_{new,t}$: 第 $t$ 周**开始**一个为期两周培训任务的**新**熟练工（培训师）人数。
    *   $n_t^{start}$: 第 $t$ 周**开始**接受培训的新工人数（学员）。

*   **状态与生产变量 (连续非负类型)**
    *   $S_{new,t}^{avail}$: 第 $t$ 周初可用的**新**熟练工总数。
    *   $X_{p,t}$: 第 $t$ 周产品 $p$ 的生产量 (公斤)。
    *   $B_{p,t}$: 第 $t$ 周末产品 $p$ 的积压量 (公斤)。

## 目标函数 (Objective Function)
目标是最小化8周内的总成本，该成本由总工资和总罚款构成。

*   **最小化总成本:**
    $\min Z = \sum_{t \in T} \left( \text{工资成本}_t + \text{罚款成本}_t \right)$

    其中，每周的成本构成为：
    *   **工资成本$_t$**:
        *   **生产人员工资**: $W_{orig\_reg} \cdot s_{orig,t}^{reg} + W_{ot} \cdot s_{orig,t}^{ot} + W_{new\_reg} \cdot s_{new,t}^{reg} + W_{ot} \cdot s_{new,t}^{ot}$
        *   **培训师工资**: $W_{orig\_reg} \cdot (T_{orig,t} + T_{orig,t-1}) + W_{new\_reg} \cdot (T_{new,t} + T_{new,t-1})$
        *   **学员工资**: $W_{trainee} \cdot (n_t^{start} + n_{t-1}^{start})$
    *   **罚款成本$_t$**: $\sum_{p \in P} C_p \cdot B_{p,t}$

## 约束条件 (Constraints)

1.  **劳动力守恒约束 (Workforce Conservation)**
    *   **说明:** 每周，各类员工的总数必须等于其可用人数。一个员工的状态分为：常规生产、加班生产、或被为期两周的培训任务占用。
    *   **公式 (初始熟练工):** $s_{orig,t}^{reg} + s_{orig,t}^{ot} + (T_{orig,t} + T_{orig,t-1}) = S_{orig}, \quad \forall t \in T$
    *   **公式 (新熟练工):** $s_{new,t}^{reg} + s_{new,t}^{ot} + (T_{new,t} + T_{new,t-1}) = S_{new,t}^{avail}, \quad \forall t \in T$

2.  **劳动力动态演化约束 (Workforce Dynamics)**
    *   **说明:** 每周初可用的新熟练工数量，等于上一周的数量加上两周前开始培训并于本周初完成培训的人数。
    *   **公式:** $S_{new,t}^{avail} = S_{new,t-1}^{avail} + n_{t-2}^{start}, \quad \forall t \in T, t \ge 2$

3.  **培训约束 (Training Constraints)**
    *   **说明:** 在第 $t$ 周新开始的培训批次中，招收的学员数不能超过该批次培训师总数的 $K$ 倍。
    *   **公式 (培训能力):** $n_t^{start} \le K \cdot (T_{orig,t} + T_{new,t}), \quad \forall t \in T$
    *   **说明:** 必须在计划周期内完成总计 $N_{target}$ 名新工人的培训。由于培训周期为2周，所有培训最晚需在第7周开始。
    *   **公式 (总培训目标):** $\sum_{t=1}^{7} n_t^{start} = N_{target}$

4.  **生产能力约束 (Production Capacity)**
    *   **说明:** 生产所有产品所需的总工时，不能超过所有参与生产的工人的总可用工时。
    *   **公式:** $\sum_{p \in P} R_p \cdot X_{p,t} \le H_{reg} \cdot (s_{orig,t}^{reg} + s_{new,t}^{reg}) + H_{ot} \cdot (s_{orig,t}^{ot} + s_{new,t}^{ot}), \quad \forall t \in T$

5.  **积压平衡约束 (Backlog Balance)**
    *   **说明:** 每周末的积压量等于上周末的积压量加上本周的新需求，再减去本周的产量。
    *   **公式:** $B_{p,t} = B_{p,t-1} + D_{p,t} - X_{p,t}, \quad \forall p \in P, \forall t \in T$

6.  **初始与边界条件 (Initial & Boundary Conditions)**
    *   **说明:** 定义计划开始前及超出培训窗口期的状态。
    *   **公式:**
        *   $B_{p,0} = 0, \quad \forall p \in P$
        *   $S_{new,1}^{avail} = 0$
        *   $n_t^{start} = 0, \quad \forall t \le 0 \text{ or } t \ge 8$
        *   $T_{orig,t} = 0, T_{new,t} = 0, \quad \forall t \le 0 \text{ or } t \ge 8$

7.  **变量类型与非负约束 (Variable Domain)**
    *   **说明:** 人员分配变量为非负整数，其他变量为非负实数。
    *   **公式:**
        *   $s_{orig,t}^{reg}, s_{orig,t}^{ot}, s_{new,t}^{reg}, s_{new,t}^{ot}, T_{orig,t}, T_{new,t}, n_t^{start} \in \mathbb{Z}^+, \quad \forall t \in T$
        *   $X_{p,t}, B_{p,t}, S_{new,t}^{avail} \ge 0, \quad \forall p \in P, \forall t \in T$