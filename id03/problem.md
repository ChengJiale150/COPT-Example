# 问题

## 问题描述
一家折叠桌公司需要为其6个月（1月至6月）的运营制定一个最优的生产与人力资源计划，目标是最大化总净利润。该计划需详细说明每月的内部产量、外包数量以及员工管理（招聘与解雇）决策。

## 问题分析
这是一个典型的**多周期生产与人力资源规划问题**。其核心是在一个有限的时间范围内，通过动态调整生产、库存、外包和劳动力水平，来满足波动的市场需求，并最终实现利润最大化。由于员工招聘、解雇和保有数量必须为整数，此问题最精确的模型是**混合整数线性规划 (Mixed-Integer Linear Programming, MILP)**。

## 核心假设
1.  **确定性环境**: 所有参数，包括未来需求、成本和生产率，在规划期内都是已知且不变的。
2.  **线性关系**: 成本、收入和资源消耗与决策变量之间均为线性关系。例如，生产成本与产量成正比。
3.  **即时性**: 招聘、解雇、生产和外包都在当月完成并生效。新雇佣的员工当月即可投入生产。
4.  **无损耗**: 生产和库存过程中没有物料或产品的损耗。

## 数据定义
此问题中的数据涵盖了时间、初始状态、成本、收入、生产参数和需求预测。

*   **集合 (Sets)**
    *   $T$: 规划周期的月份集合, $T = \{1, 2, 3, 4, 5, 6\}$，分别代表1月到6月。

*   **参数 (Parameters)**
    *   **初始状态 (t=0)**
        *   $W_0$: 初始员工数量 = 1,000 人
        *   $I_0$: 初始库存 = 15,000 件
        *   $B_0$: 初始缺货订单 = 0 件
    *   **收入与成本**
        *   $R$: 单位产品售价 = 300 元/件
        *   $C^{mat}$: 单位产品原材料成本 = 90 元/件
        *   $C^{out}$: 单位产品外包成本 = 200 元/件
        *   $C^{inv}$: 单位产品月度库存持有成本 = 15 元/件
        *   $C^{back}$: 单位产品月度缺货成本 = 35 元/件
        *   $C^{hire}$: 每位员工的招聘成本 = 5,000 元/人
        *   $C^{fire}$: 每位员工的解雇成本 = 8,000 元/人
        *   $C^{wage\_reg}$: 每小时正常工资 = 30 元/小时
        *   $C^{wage\_ot}$: 每小时加班工资 = 40 元/小时
    *   **生产与劳动力**
        *   $L^{req}$: 生产单位产品所需工时 = 5 小时/件
        *   $H^{reg}$: 每位员工每月正常工作时长 = 160 小时/人
        *   $H^{ot\_max}$: 每位员工每月最大加班时长 = 20 小时/人
    *   **需求预测**
        *   $D_t$: 第 $t$ 月的需求预测量 (单位: 件)。$D = \{20000, 40000, 42000, 35000, 19000, 18500\}$
    *   **期末条件**
        *   $I_{final}$: 期末（6月底）最低库存要求 = 10,000 件
        *   $B_{final}$: 期末（6月底）缺货订单要求 = 0 件

# 数学形式

## 变量定义
我们为每个规划周期 $t \in T$ 定义以下决策变量：

*   $P_t$: 在第 $t$ 月的内部生产数量 (单位: 件)。
*   $O_t$: 在第 $t$ 月的外包采购数量 (单位: 件)。
*   $I_t$: 在第 $t$ 月末的库存数量 (单位: 件)。
*   $B_t$: 在第 $t$ 月末的缺货订单数量 (单位: 件)。
*   $W_t$: 在第 $t$ 月的员工总数 (单位: 人)。
*   $H_t$: 在第 $t$ 月初招聘的员工数量 (单位: 人)。
*   $F_t$: 在第 $t$ 月初解雇的员工数量 (单位: 人)。
*   $OT_t$: 在第 $t$ 月使用的总加班工时 (单位: 小时)。

## 目标函数
目标是最大化6个月的总净利润。总净利润 = 总收入 - 总成本。本月销售量等于本月需求加上期初缺货量减去期末缺货量，即 $(D_t + B_{t-1} - B_t)$。

**最大化总净利润:**
$\max \sum_{t \in T} \left( R \cdot (D_t + B_{t-1} - B_t) - C^{mat} \cdot P_t - C^{out} \cdot O_t - C^{inv} \cdot I_t - C^{back} \cdot B_t - C^{wage\_reg} \cdot H^{reg} \cdot W_t - C^{wage\_ot} \cdot OT_t - C^{hire} \cdot H_t - C^{fire} \cdot F_t \right)$

## 约束条件
模型必须满足以下一系列约束条件，$\forall t \in T$:

1.  **员工数量平衡约束 (Workforce Balance):**
    *   **说明:** 每个月的员工数量由上个月的数量加上本月新招聘和解雇的人数决定。
    *   **公式:** $W_t = W_{t-1} + H_t - F_t$
    *   **注:** 对于 $t=1$，该约束为 $W_1 = W_0 + H_1 - F_1$。

2.  **库存与缺货平衡约束 (Inventory & Backorder Balance):**
    *   **说明:** 本月末的净库存（库存减缺货）等于上月末的净库存，加上本月总供给（内部生产+外包），减去本月需求。此公式巧妙地确保了库存与缺货的互斥性：由于同时持有库存（产生$C^{inv}$成本）和缺货（产生$C^{back}$成本）在经济上是不合理的，任何以利润最大化为目标的解都会自然地使$I_t$和$B_t$中至少有一个为零。
    *   **公式:** $I_t - B_t = (I_{t-1} - B_{t-1}) + P_t + O_t - D_t$
    *   **注:** 对于 $t=1$，该约束为 $I_1 - B_1 = (I_0 - B_0) + P_1 + O_1 - D_1$。

3.  **生产工时约束 (Production Labor Hour):**
    *   **说明:** 用于生产的总工时不能超过员工能提供的总工时（正常工时+加班工时）。
    *   **公式:** $L^{req} \cdot P_t \le H^{reg} \cdot W_t + OT_t$

4.  **加班工时上限约束 (Overtime Limit):**
    *   **说明:** 当月总加班时长不能超过全体员工的最大允许加班时长。
    *   **公式:** $OT_t \le H^{ot\_max} \cdot W_t$

5.  **期末状态约束 (Terminal Conditions):**
    *   **说明:** 规划期结束时（6月底），必须满足特定的库存和缺货要求。
    *   **公式 (for t=6):**
        *   $I_6 \ge I_{final}$
        *   $B_6 = B_{final}$

6.  **变量非负性与类型约束 (Variable Non-negativity and Type):**
    *   **说明:** 所有决策变量都必须是非负的。人力资源相关决策必须为整数。
    *   **公式:**
        *   $P_t, O_t, I_t, B_t, OT_t \ge 0$
        *   $W_t, H_t, F_t \in \mathbb{Z}^+$ (非负整数)