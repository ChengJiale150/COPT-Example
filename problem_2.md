# 问题 (Problem)

## 问题描述 (Problem Description)
一家工厂生产两种食品（I和II），现有50名熟练工人。在8周的规划期内，工厂需满足每周不断增长的合同订单需求。为应对产能压力，工厂计划在第8周结束前完成对50名新工人的培训。

生产、培训和薪酬规则如下：
1.  **产能：** 一名熟练工人每周工作40小时，每小时可生产10公斤食品I或6公斤食品II。
2.  **加班：** 工厂可安排部分熟练工人每周工作60小时，其周薪相应提高。
3.  **培训：** 一名培训师在两周内最多可培训三名新工人。在为期两周的培训期间，培训师和学员均不参与生产。
4.  **薪酬：**
    *   熟练工人（正常工时/培训）：360元/周。
    *   熟练工人（加班）：540元/周。
    *   学员（培训期）：120元/周。
    *   新工人（培训后）：240元/周，生产效率与熟练工相同。
5.  **延期罚款：** 若未能按时交付订单，食品I的延期罚款为每公斤每周0.5元，食品II为每公斤每周0.6元。

工厂的目标是制定一个综合的人员分配、生产和培训计划，以最小化未来8周内的总成本（包括工资和延期罚款）。

## 问题分析 (Problem Analysis)
这是一个典型的**多周期生产与劳动力规划问题**，属于**混合整数线性规划 (Mixed-Integer Linear Programming, MILP)** 的范畴。

问题的核心在于跨时间周期的决策权衡：
*   **当前 vs. 未来：** 将熟练工人用于当前生产可以立即满足需求，但会延迟新工人的培训，可能导致后期因劳动力不足而产生更高的延期成本。
*   **成本构成：** 总成本由三部分构成：熟练工人工资、新工人工资（学员及转正后）和延期交付的罚款。模型需要精确计算并加总这些成本。
*   **动态系统：** 系统的状态（如熟练工人数量、在训学员数量、累计欠货量）每周都在变化，本周的决策会直接影响下一周及未来的可用资源和约束。

**关键隐含假设与解读：**
1.  **培训完成期限：** “在第8周结束前完成培训”意味着新工人的培训最迟必须在第6周结束时开始（第7、8周完成培训），以便在第8周末成为合格工人。因此，招募新学员的决策仅在前6周内有效。
2.  **新工人的工作模式：** 问题未明确新工人（培训后）是否可以加班。我们做出一个合理的假设：**新培训的工人仅按正常工时工作，不参与加班**。
3.  **新工人的角色：** 我们假设，新工人在培训合格后，不仅具备与熟练工相同的生产效率，**同样具备担任培训师的能力**。这是一个关键假设，因为它直接影响了后期培训能力的扩展速度。
4.  **培训师薪酬：** 我们假设，担任培训师的工人（无论是原始熟练工还是新工人）均按其**正常工时薪酬标准**计薪。即，熟练工培训师为360元/周，新工人培训师为240元/周。
5.  **延期罚款计算：** 罚款是“每公斤每周”，这意味着每周结束时，所有未完成的订单（欠货量）都会产生一次罚款。

## 数据定义 (Data Definition)
此问题中的数据主要包括时间周期、食品种类、人员属性和成本参数。

*   **集合 (Sets)**
    *   $T$: 规划期内的周数集合, $T = \{1, 2, 3, 4, 5, 6, 7, 8\}$。
    *   $F$: 食品种类的集合, $F = \{I, II\}$。

*   **参数 (Parameters)**
    *   $S_0$: 初始熟练工人数量， $S_0 = 50$。
    *   $N_{total}$: 计划培训的新工人总数， $N_{total} = 50$。
    *   $H_{norm}$: 正常工作时长（小时/周），$H_{norm} = 40$。
    *   $H_{over}$: 加班工作时长（小时/周），$H_{over} = 60$。
    *   $R_I$: 食品I的生产效率（公斤/小时），$R_I = 10$。
    *   $R_{II}$: 食品II的生产效率（公斤/小时），$R_{II} = 6$。
    *   $K_{train}$: 每名培训师最多能带的学员数量， $K_{train} = 3$。
    *   $W_{skilled\_norm}$: 熟练工人正常周薪， $W_{skilled\_norm} = 360$ 元。
    *   $W_{skilled\_over}$: 熟练工人加班周薪， $W_{skilled\_over} = 540$ 元。
    *   $W_{trainee}$: 学员周薪， $W_{trainee} = 120$ 元。
    *   $W_{new}$: 新工人周薪， $W_{new} = 240$ 元。
    *   $C_I$: 食品I延期罚款（元/公斤/周），$C_I = 0.5$。
    *   $C_{II}$: 食品II延期罚款（元/公斤/周），$C_{II} = 0.6$。
    *   $D_{f,t}$: 第 $t$ 周对食品 $f$ 的需求量（公斤）。

**每周需求量 $D_{f,t}$**
| 周 (t) | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 食品I需求 | 10000 | 10000 | 12000 | 12000 | 16000 | 16000 | 20000 | 20000 |
| 食品II需求| 6000 | 7200 | 8400 | 10800 | 10800 | 12000 | 12000 | 12000 |

# 数学形式 (Mathematical Formulation)

## 变量定义 (Variable Definition)
为了描述每周的人员分配、生产和欠货情况，我们定义以下决策变量：

*   **人员分配变量 (Integer, Non-negative):** $\forall t \in T$
    *   $s_{norm, t}$: 第 $t$ 周从事正常工时生产的**原始熟练工**人数。
    *   $s_{over, t}$: 第 $t$ 周从事加班生产的**原始熟练工**人数。
    *   $s_{train, t}$: 第 $t$ 周从事培训工作的**原始熟练工**人数。
    *   $n_{start, t}$: 第 $t$ 周**开始**接受培训的新工人数。
    *   $n_{prod, t}$: 第 $t$ 周从事正常工时生产的**新转正工人**数量。
    *   $n_{train, t}$: 第 $t$ 周从事培训工作的**新转正工人**数量。

*   **生产与状态变量 (Continuous, Non-negative):** $\forall t \in T, \forall f \in F$
    *   $p_{f, t}$: 第 $t$ 周食品 $f$ 的生产量（公斤）。
    *   $b_{f, t}$: 第 $t$ 周结束时食品 $f$ 的累计欠货量（公斤）。

*   **辅助状态变量 (For Clarity):** $\forall t \in T$
    *   $N_{trainee, t}$: 第 $t$ 周正在接受培训的**学员总数**。
    *   $N_{new\_skilled, t}$: 第 $t$ 周初，可用的**新转正工人总数**。

## 目标函数 (Objective Function)
目标是最小化8周内的总成本，该成本由三部分构成：工人工资和延期罚款。

*   **最小化总成本:**
    $\min Z = \sum_{t=1}^8 \left[ \left( W_{skilled\_norm} \cdot (s_{norm, t} + s_{train, t}) + W_{skilled\_over} \cdot s_{over, t} \right) + \left( W_{new} \cdot (n_{prod, t} + n_{train, t}) \right) + \left( W_{trainee} \cdot N_{trainee, t} \right) + \left( \sum_{f \in F} C_f \cdot b_{f, t} \right) \right]$

## 约束条件 (Constraints)
1.  **原始熟练工人守恒约束 (Original Skilled Worker Conservation):**
    *   **说明:** 每周，所有初始的50名熟练工人都必须被分配到生产（正常/加班）或培训任务中。
    *   **公式:** $s_{norm, t} + s_{over, t} + s_{train, t} = S_0, \quad \forall t \in T$

2.  **新转正工人守恒约束 (New Skilled Worker Conservation):**
    *   **说明:** 每周，所有已完成培训的新工人都必须被分配到生产或培训任务中。
    *   **公式:** $n_{prod, t} + n_{train, t} = N_{new\_skilled, t}, \quad \forall t \in T$

3.  **新工人培训总数约束 (Total New Trainees Target):**
    *   **说明:** 到规划期结束时，必须总共培训50名新工人。培训最迟需在第6周开始。
    *   **公式:** $\sum_{t=1}^6 n_{start, t} = N_{total}$
    *   **公式:** $n_{start, t} = 0, \quad \forall t \in \{7, 8\}$

4.  **培训能力约束 (Training Capacity):**
    *   **说明:** 每周在岗的培训师总数（包括原始熟练工人和新转正工人）必须足以支持所有在训学员（本周新开始的和上周开始的）。
    *   **公式:** $s_{train, t} + n_{train, t} \ge \frac{N_{trainee, t}}{K_{train}}, \quad \forall t \in T$

5.  **生产能力约束 (Production Capacity):**
    *   **说明:** 两种食品的总生产工时不能超过当周所有生产工人的总可用工时。这包括正常工时的熟练工、加班的熟练工以及从事生产的新工人。
    *   **公式:** $\frac{p_{I, t}}{R_I} + \frac{p_{II, t}}{R_{II}} \le H_{norm} \cdot s_{norm, t} + H_{over} \cdot s_{over, t} + H_{norm} \cdot n_{prod, t}, \quad \forall t \in T$

6.  **欠货平衡约束 (Backlog Balance):**
    *   **说明:** 每周末的欠货量等于上周的欠货量加上本周的需求量，再减去本周的生产量。
    *   **公式:** $b_{f, t} = b_{f, t-1} + D_{f, t} - p_{f, t}, \quad \forall t \in T, \forall f \in F$
    *   *(初始条件: $b_{f, 0} = 0$)*

7.  **辅助状态变量定义 (State Variable Definitions):**
    *   **说明:** 定义每周的在训学员总数和可用的新转正工人总数。
    *   **公式 (在训学员):** $N_{trainee, t} = n_{start, t} + n_{start, t-1}, \quad \forall t \in T$
    *   **公式 (新转正工人):** $N_{new\_skilled, t} = \sum_{k=1}^{t-2} n_{start, k}, \quad \forall t \in T$
    *   *(初始条件: $n_{start, k} = 0$ for $k \le 0$)*

8.  **变量域约束 (Variable Domain):**
    *   **说明:** 人员数量必须为非负整数，生产量和欠货量为非负实数。
    *   **公式:**
        *   $s_{norm, t}, s_{over, t}, s_{train, t}, n_{start, t}, n_{prod, t}, n_{train, t} \in \mathbb{Z}^+, \quad \forall t \in T$
        *   $p_{f, t} \ge 0, \quad b_{f, t} \ge 0, \quad \forall t \in T, \forall f \in F$